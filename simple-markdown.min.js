!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).SimpleMarkdown=e()}(this,function(){"use strict";function r(t){return t.replace(h,"\n").replace(v,"").replace(m,"    ")}function l(t,e){var n=t||{};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function t(h,n){var m,v=Object.keys(h).filter(function(t){var e=h[t];if(null==e||null==e.match)return!1;var n=e.order;return"number"==typeof n&&isFinite(n)||"undefined"==typeof console||console.warn("simple-markdown: Invalid order for rule `"+t+"`: "+String(n)),!0});v.sort(function(t,e){var n=h[t],r=h[e],o=n.order,u=r.order;if(o!==u)return o-u;var a=n.quality?0:1,i=r.quality?0:1;return a!=i?a-i:t<e?-1:e<t?1:0});var g=function(t,e){var n=[];for(m=e=e||m;t;){var r=null,o=null,u=null,a=NaN,i=0,l=v[0],c=h[l];do{var f=c.order,p=null==e.prevCapture?"":e.prevCapture[0],s=c.match(t,e,p);if(s){var d=c.quality?c.quality(s,e,p):0;d<=a||(r=l,o=c,u=s,a=d)}l=v[++i],c=h[l]}while(c&&(!u||c.order===f&&c.quality));if(null==o||null==u)throw new Error("Could not find a matching rule for the below content. The rule with highest `order` should always match content provided to it. Check the definition of `match` for '"+v[v.length-1]+"'. It seems to not match the following source:\n"+t);if(u.index)throw new Error("`match` must return a capture starting at index 0 (the current parse index). Did you forget a ^ at the start of the RegExp?");var y=o.parse(u,g,e);Array.isArray(y)?Array.prototype.push.apply(n,y):(null==y.type&&(y.type=r),n.push(y)),e.prevCapture=u,t=t.substring(e.prevCapture[0].length)}return n};return function(t,e){return(m=l(e,n)).inline||m.disableAutoBlockNewlines||(t+="\n\n"),m.prevCapture=null,g(r(t),m)}}function e(n){function t(t,e){return e.inline?n.exec(t):null}return t.regex=n,t}function n(n){function t(t,e){return n.exec(t)}return t.regex=n,t}function o(t,e,n){return{$$typeof:g,type:t,key:null==e?void 0:e,ref:null,props:n,_owner:null}}function u(t,e,n,r){n=n||{},r=void 0===r||r;var o="";for(var u in n){var a=n[u];Object.prototype.hasOwnProperty.call(n,u)&&a&&(o+=" "+y(u)+'="'+y(a)+'"')}var i="<"+t+o+">";return r?i+e+"</"+t+">":i}function a(t){if(null==t)return null;try{var e=new URL(t,"https://localhost").protocol;if(0===e.indexOf("javascript:")||0===e.indexOf("vbscript:")||0===e.indexOf("data:"))return null}catch(t){return null}return t}function i(t){return t.replace(b,"$1")}function c(t,e,n){var r=n.inline||!1;n.inline=!0;var o=t(e,n);return n.inline=r,o}function f(n,r,o){if(!r)throw new Error("simple-markdown: outputFor: `property` must be defined. if you just upgraded, you probably need to replace `outputFor` with `reactFor`");var u,t=(n.Array||S.Array)[r];if(!t)throw new Error("simple-markdown: outputFor: to join nodes of type `"+r+"` you must provide an `Array:` joiner rule with that type, Please see the docs for details on specifying an Array rule.");var a=t,i=function(t,e){return u=e=e||u,Array.isArray(t)?a(t,i,e):n[t.type][r](t,i,e)};return function(t,e){return u=l(e,o),i(t,u)}}function p(t,e){return(e=e||{}).inline=!1,R(t,e)}function s(t,e){var n=A.test(t);return(e=e||{}).inline=!n,R(t,e)}function d(t,e){return P(p(t,e),e)}function y(t){return String(t).replace(x,function(t){return k[t]})}var h=/\r\n?/g,m=/\t/g,v=/\f/g,g="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,w={},x=/[<>&"']/g,k={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#96;"},b=/\\([^0-9A-Za-z\s])/g,A=/\n{2,}$/,O=0,S={Array:{react:function(t,e,n){for(var r=n.key,o=[],u=0;u<t.length;u++){n.key=""+u;var a=t[u];if("text"===a.type){a={type:"text",content:a.content};for(var i=t[u+1];u+1<t.length&&"text"===i.type;u++)a.content+=i.content}o.push(e(a,n))}return n.key=r,o},html:function(t,e,n){for(var r="",o=0;o<t.length;o++){var u=t[o];if("text"===u.type){u={type:"text",content:u.content};for(var a=t[o+1];o+1<t.length&&"text"===a.type;o++)u.content+=a.content}r+=e(u,n)}return r}},url:{order:O++,match:e(/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/),parse:function(t,e,n){return{type:"link",content:[{type:"text",content:t[1]}],target:t[1],title:void 0}},react:null,html:null},link:{order:O++,match:e(new RegExp("^\\[((?:\\[[^\\]]*\\]|[^\\[\\]]|\\](?=[^\\[]*\\]))*)\\]\\(\\s*<?((?:\\([^)]*\\)|[^\\s\\\\]|\\\\.)*?)>?(?:\\s+['\"]([\\s\\S]*?)['\"])?\\s*\\)")),parse:function(t,e,n){return{content:e(t[1],n),target:i(t[2]),title:t[3]}},react:function(t,e,n){return o("a",n.key,{href:a(t.target),title:t.title,children:e(t.content,n)})},html:function(t,e,n){var r={href:a(t.target),title:t.title};return u("a",e(t.content,n),r)}},em:{order:O,match:e(new RegExp("^\\b_((?:__|\\\\[\\s\\S]|[^\\\\_])+?)_\\b|^\\*(?=\\S)((?:\\*\\*|\\\\[\\s\\S]|\\s+(?:\\\\[\\s\\S]|[^\\s\\*\\\\]|\\*\\*)|[^\\s\\*\\\\])+?)\\*(?!\\*)")),quality:function(t){return t[0].length+.2},parse:function(t,e,n){return{content:e(t[2]||t[1],n)}},react:function(t,e,n){return o("em",n.key,{children:e(t.content,n)})},html:function(t,e,n){return u("em",e(t.content,n))}},strong:{order:O,match:e(/^\*\*((?:\\[\s\S]|[^\\])+?)\*\*(?!\*)/),quality:function(t){return t[0].length+.1},parse:function(t,e,n){return{content:c(e,t[1],n)}},react:function(t,e,n){return o("strong",n.key,{children:e(t.content,n)})},html:function(t,e,n){return u("strong",e(t.content,n))}},br:{order:O++,match:n(/^\n/),parse:function(){return{}},react:function(t,e,n){return o("br",n.key,w)},html:function(t,e,n){return"<br>"}},text:{order:O++,match:n(/^[\s\S]+?(?=[^0-9A-Za-z\s\u00c0-\uffff]|\n|\w+:\S|$)/),parse:function(t,e,n){return{content:t[0]}},react:function(t,e,n){return t.content},html:function(t,e,n){return y(t.content)}}},R=t(S),P=f(S,"react"),j=f(S,"html");return{defaultRules:S,parserFor:t,outputFor:f,inlineRegex:e,blockRegex:function(n){function t(t,e){return e.inline?null:n.exec(t)}return t.regex=n,t},anyScopeRegex:n,parseInline:c,parseBlock:function(t,e,n){var r=n.inline||!1;n.inline=!1;var o=t(e+"\n\n",n);return n.inline=r,o},markdownToReact:d,markdownToHtml:function(t,e){return j(p(t,e),e)},ReactMarkdown:function(t){var e={};for(var n in t)"source"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.children=d(t.source),o("div",null,e)},defaultBlockParse:p,defaultInlineParse:function(t,e){return(e=e||{}).inline=!0,R(t,e)},defaultImplicitParse:s,defaultReactOutput:P,defaultHtmlOutput:j,preprocess:r,sanitizeText:y,sanitizeUrl:a,unescapeUrl:i,htmlTag:u,reactElement:o,defaultRawParse:R,ruleOutput:function(r,o){return o||"undefined"==typeof console||console.warn("simple-markdown ruleOutput should take 'react' or 'html' as the second argument."),function(t,e,n){return r[t.type][o](t,e,n)}},reactFor:function(i){var l=function(t,e){if(e=e||{},Array.isArray(t)){for(var n=e.key,r=[],o=null,u=0;u<t.length;u++){e.key=""+u;var a=l(t[u],e);"string"==typeof a&&"string"==typeof o?(o+=a,r[r.length-1]=o):(r.push(a),o=a)}return e.key=n,r}return i(t,l,e)};return l},htmlFor:function(n){var r=function(t,e){return e=e||{},Array.isArray(t)?t.map(function(t){return r(t,e)}).join(""):n(t,r,e)};return r},defaultParse:function(){return"undefined"!=typeof console&&console.warn("defaultParse is deprecated, please use `defaultImplicitParse`"),s.apply(null,arguments)},defaultOutput:function(){return"undefined"!=typeof console&&console.warn("defaultOutput is deprecated, please use `defaultReactOutput`"),P.apply(null,arguments)}}});